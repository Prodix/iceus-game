<script setup>
    import map from '../assets/map.svg';
    import marker from '../assets/marker.svg';
    import {ref} from 'vue';

    const showedPathCount = ref(0);

    const maximize = () => {
        const schema = document.getElementById('map');
        schema.style.width = '100vw';
        schema.style.left = '0';
        schema.style.top = '0';
        schema.style.height = '100vh';
    }

    const minimize = () => {
        const schema = document.getElementById('map');
        schema.style.width = '';
        schema.style.left = '';
        schema.style.top = '';
        schema.style.height = '';
    }

    const showNextPath = () => {
        showedPathCount.value++;
    }

    defineExpose({
        maximize,
        minimize,
        showNextPath
    });

</script>

<template>
    <div id="map">
        <div>
            <img :src="map">
            <svg class="marker" id="marker-1" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 0 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 0 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <svg class="marker" id="marker-2" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 1 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 1 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <svg class="marker" id="marker-3" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 2 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 2 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <svg class="marker" id="marker-4" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 3 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 3 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <svg class="marker" id="marker-5" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 4 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 4 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <svg class="marker" id="marker-6" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 5 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 5 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <svg class="marker" id="marker-7" viewBox="0 0 56 84" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M27.9814 3.97607C12.5644 3.97607 0.0651855 16.3393 0.0651855 31.8931C0.0651855 37.0777 1.66722 42.2621 4.42742 46.649C4.56062 47.0479 4.66272 47.0482 4.80151 47.447L22.1228 79.3521C22.9364 81.745 25.2416 83.739 27.8578 83.739C30.474 83.739 32.6515 81.745 33.4651 79.3521L52.7837 44.655C54.7738 40.6668 55.8984 36.2801 55.8984 31.8931C55.8984 16.3393 43.3996 3.97607 27.9814 3.97607ZM27.8578 19.5299C35.5669 19.5299 41.8163 25.911 41.8163 33.4885C41.8163 41.4647 35.5669 47.447 27.8578 47.447C20.1487 47.447 13.8993 41.4647 13.8993 33.4885C13.8993 25.911 20.1487 19.5299 27.8578 19.5299Z" :fill="showedPathCount >= 6 ? '#C0392B' : '#5A5A5A'"/>
                <path d="M27.9814 0.112305C12.5644 0.112305 0.0651855 12.6112 0.0651855 28.0293C0.0651855 33.5449 1.66722 38.6569 4.42742 42.9841C4.56062 43.1955 4.66272 43.4028 4.80151 43.6102L22.1228 75.7627C22.9364 78.0997 25.2416 79.8744 27.8578 79.8744C30.474 79.8744 32.6515 78.0997 33.4651 75.7627L52.7837 40.8664C54.7738 37.0258 55.8984 32.6508 55.8984 28.0293C55.8984 12.6112 43.3996 0.112305 27.9814 0.112305ZM27.8578 15.9405C35.5669 15.9405 41.8163 22.1899 41.8163 29.899C41.8163 37.6081 35.5669 43.8575 27.8578 43.8575C20.1487 43.8575 13.8993 37.6081 13.8993 29.899C13.8993 22.1899 20.1487 15.9405 27.8578 15.9405Z" :fill="showedPathCount >= 6 ? '#E74C3C' : '#A9A9A9'"/>
            </svg>
            <transition name="path">
                <svg v-if="showedPathCount >= 1" class="path" id="path-1" width="151" height="155" viewBox="0 0 151 155" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="non-path" stroke="#E74C3C" fill="none" stroke-width="4" stroke-linecap="round" d="M149.5 2C145 21.6667 124.1 62.6 76.5 69C28.9 75.4 7 128 2 153.5"/>
                    <path class="dash-path" fill="none" stroke="white" stroke-width="7" stroke-linecap="round" d="M149.5 2C145 21.6667 124.1 62.6 76.5 69C28.9 75.4 7 128 2 153.5"/>
                </svg>
            </transition>
            <transition name="path">
                <svg v-if="showedPathCount >= 2" class="path" id="path-2" width="252" height="135" viewBox="0 0 252 135" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="non-path" stroke="#E74C3C" fill="none" stroke-width="4" stroke-linecap="round" d="M250.5 133.5C222 57.1667 132.4 -66.2999 2 50.5001"/>
                    <path class="dash-path" fill="none" stroke="white" stroke-width="7" stroke-linecap="round" d="M250.5 133.5C222 57.1667 132.4 -66.2999 2 50.5001"/>
                </svg>
            </transition>
            <transition name="path">
                <svg v-if="showedPathCount >= 3" class="path" id="path-3" width="467" height="190" viewBox="0 0 467 190" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="non-path" stroke="#E74C3C" fill="none" stroke-width="4" stroke-linecap="round" d="M465.5 2C418 18.1667 340.5 70.5 298.5 115.5C260.583 156.126 197.5 185.5 113.5 188.5C91 186.167 27.6 185.6 2 128"/>
                    <path class="dash-path" fill="none" stroke="white" stroke-width="7" stroke-linecap="round" d="M465.5 2C418 18.1667 340.5 70.5 298.5 115.5C260.583 156.126 197.5 185.5 113.5 188.5C91 186.167 27.6 185.6 2 128"/>
                </svg>
            </transition>
            <transition name="path">
                <svg v-if="showedPathCount >= 4" class="path" id="path-4" width="184" height="234" viewBox="0 0 184 234" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="non-path" stroke="#E74C3C" fill="none" stroke-width="4" stroke-linecap="round" d="M106 232.5C146.5 217.834 214.8 164 164 66.0002C113.2 -31.9998 34.8333 3.50022 2 33.5002"/>
                    <path class="dash-path" fill="none" stroke="white" stroke-width="7" stroke-linecap="round" d="M106 232.5C146.5 217.834 214.8 164 164 66.0002C113.2 -31.9998 34.8333 3.50022 2 33.5002"/>
                </svg>
            </transition>
            <transition name="path">
                <svg v-if="showedPathCount >= 5" class="path" id="path-5" width="328" height="220" viewBox="0 0 328 220" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="non-path" stroke="#E74C3C" fill="none" stroke-width="4" stroke-linecap="round" d="M2 215.5C51.3333 222.167 161.7 216.8 208.5 142C255.3 67.2 306.333 17.5 326 2"/>
                    <path class="dash-path" fill="none" stroke="white" stroke-width="7" stroke-linecap="round" d="M2 215.5C51.3333 222.167 161.7 216.8 208.5 142C255.3 67.2 306.333 17.5 326 2"/>
                </svg>
            </transition>
            <transition name="path">
                <svg v-if="showedPathCount >= 6" class="path" id="path-6" width="262" height="59" viewBox="0 0 262 59" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path class="non-path" stroke="#E74C3C" fill="none" stroke-width="4" stroke-linecap="round" d="M1.5 8.49994C17.8333 1.99994 62.1 -5.60006 108.5 15.9999C154.9 37.5999 229.167 52.6666 260.5 57.5"/>
                    <path class="dash-path" fill="none" stroke="white" stroke-width="7" stroke-linecap="round" d="M1.5 8.49994C17.8333 1.99994 62.1 -5.60006 108.5 15.9999C154.9 37.5999 229.167 52.6666 260.5 57.5"/>
                </svg>
            </transition>
        </div>
    </div>
</template>

<style scoped>
.path-enter-active,
.path-leave-active {
  transition: opacity 3s ease;
}
.path-enter-from,
.path-leave-to {
  opacity: 0;
}
#map {
    background-color: #A8D0E7;
    width: 23.65%;
    height: 23.4%;
    position: absolute;
    left: 46.6%;
    top: 33%;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: -1;
    transition: width 2s, height 2s, left 2s, top 2s;
}
#map > div {
    position: relative;
}
#map > div > img:first-child {
    width: 90%;
    height: 90%;
}
.marker {
    position: absolute;
    height: 13.5%;
}
.marker > path {
    transition: fill 1s;
    transition-delay: 2s;
}
#marker-1 {
    left: 14%;
    top: 49%;
}
#marker-2 {
    left: 23.5%;
    top: 21%;
}
#marker-3 {
    left: 39.6%;
    top: 31%;
}
#marker-4 {
    left: 67%;
    top: 19%;
}
#marker-5 {
    left: 72.5%;
    top: 42%;
}
#marker-6 {
    left: 52%;
    top: 68%;
}
#marker-7 {
    left: 33%;
    top: 67%;
}
.path {
    width: auto;
    position: absolute;
    height: 16%;
}
#path-1 {
    left: 16.6%;
    top: 33%;
}
#path-2 {
    left: 27%;
    top: 14%;
}
#path-3 {
    left: 43%;
    top: 28%;
    height: 20.8%;
}
#path-4 {
    left: 71.5%;
    top: 19.5%;
    height: 22.8%;
}
#path-5 {
    left: 56.6%;
    top: 51%;
    height: 22.8%;
}
#path-6 {
    left: 37.5%;
    top: 67%;
    height: 6.6%;
}
.non-path {
    stroke-dasharray: 10 10;
}
.dash-path {
    stroke-dashoffset: 1000;
    stroke-dasharray: 1000;
    animation: dash 2s linear reverse;
}
@keyframes dash {
    from {
        stroke-dashoffset: 1000;
    }
    to {
        stroke-dashoffset: 0;
    }
}
</style>